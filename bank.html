<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Ğ›Ñ–ÑĞ¾Ğ²Ğ° ĞŸÑ–ÑĞ½Ñ â€” Ğ‘Ğ°Ğ½Ğº</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
  font-family:Arial;
  background:#020617;
  color:#fff;
  padding:20px
}
.box{
  max-width:420px;
  margin:auto;
  background:#020617;
  padding:20px;
  border-radius:16px;
  box-shadow:0 0 30px rgba(0,0,0,.6)
}
input,button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:10px;
  border:none;
  font-size:15px
}
input{background:#0f172a;color:#fff}
button{
  background:#22c55e;
  color:#000;
  font-weight:bold;
  cursor:pointer
}
.hidden{display:none}
.balance{text-align:center;font-size:20px;margin:15px 0}
.service{
  background:#0f172a;
  padding:12px;
  border-radius:10px;
  margin-top:10px
}
</style>
</head>

<body>
<div class="box">

<!-- LOGIN -->
<div id="loginBox">
  <h2>ğŸ” Ğ’Ñ…Ñ–Ğ´</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ">
  <button onclick="loginUser()">Ğ£Ğ²Ñ–Ğ¹Ñ‚Ğ¸</button>
</div>

<!-- BANK -->
<div id="bankBox" class="hidden">
  <h2>ğŸŒ² Ğ›Ñ–ÑĞ¾Ğ²Ğ° ĞŸÑ–ÑĞ½Ñ â€” Ğ‘Ğ°Ğ½Ğº</h2>

  <div class="balance">
    Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: <b><span id="balance">0</span></b> Ğ³Ñ€Ğ½
  </div>

  <button onclick="toggleServices()">ğŸ› ĞŸĞ¾ÑĞ»ÑƒĞ³Ğ¸</button>

  <div id="servicesBox" class="hidden">
    <div class="service">ğŸ¬ Ğ¦ÑƒĞºĞµÑ€ĞºĞ° â€” 5 Ğ³Ñ€Ğ½
      <button onclick="buy(5)">ĞšÑƒĞ¿Ğ¸Ñ‚Ğ¸</button>
    </div>

    <div class="service">ğŸ’§ Ğ’Ğ¾Ğ´Ğ° â€” 3 Ğ³Ñ€Ğ½
      <button onclick="buy(3)">ĞšÑƒĞ¿Ğ¸Ñ‚Ğ¸</button>
    </div>

    <div class="service">ğŸ¥¤ ĞšĞ¾ĞºĞ°-ĞºĞ¾Ğ»Ğ° â€” 8 Ğ³Ñ€Ğ½
      <button onclick="buy(8)">ĞšÑƒĞ¿Ğ¸Ñ‚Ğ¸</button>
    </div>

    <div class="service">
      ğŸŒ² Ğ›Ñ–ÑĞ½Ğ¸Ñ‡ĞºĞ¸ â€” 0.3 Ğ³Ñ€Ğ½
      <input id="qty" type="number" min="1" value="1">
      <button onclick="buyLis()">ĞšÑƒĞ¿Ğ¸Ñ‚Ğ¸</button>
    </div>

    <button onclick="window.open('https://www.privat24.ua/send/ijak6','_blank')">
      ğŸ’³ ĞĞ¿Ğ»Ğ°Ñ‚Ğ¸Ñ‚Ğ¸ Ñ‡ĞµÑ€ĞµĞ· ĞŸÑ€Ğ¸Ğ²Ğ°Ñ‚24
    </button>
  </div>

  <button style="margin-top:15px" onclick="logout()">ğŸšª Ğ’Ğ¸Ğ¹Ñ‚Ğ¸</button>
</div>

</div>

<script>
// ğŸ”— Supabase
const sb = supabase.createClient(
  "https://mefzopeenhfdqfatbjaq.supabase.co",
  "sb_publishable_LU94dUJoW2jwZJ9WIdfsMw_lEnMQobx"
);

let currentUser = null;
let currentBalance = 0;

// ğŸ” Ğ›ĞĞ“Ğ†Ğ
async function loginUser(){
  const e = email.value.trim();
  const p = password.value.trim();

  const { data:user } = await sb
    .from("users")
    .select("*")
    .eq("email", e)
    .eq("password_hash", p)
    .maybeSingle();

  if(!user){
    alert("âŒ ĞĞµĞ²Ñ–Ñ€Ğ½Ğ¸Ğ¹ email Ğ°Ğ±Ğ¾ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ");
    return;
  }

  currentUser = user;

  const { data:bank } = await sb
    .from("bank")
    .select("balance")
    .eq("user_id", user.id)
    .maybeSingle();

  currentBalance = bank ? Number(bank.balance) : 0;

  loginBox.classList.add("hidden");
  bankBox.classList.remove("hidden");
  updateBalance();
}

// ğŸ’° Ğ‘ĞĞ›ĞĞĞ¡
function updateBalance(){
  balance.innerText = currentBalance.toFixed(2);
}

// ğŸ› ĞŸĞĞ¡Ğ›Ğ£Ğ“Ğ˜
function toggleServices(){
  servicesBox.classList.toggle("hidden");
}

// ğŸ’¸ ĞŸĞĞšĞ£ĞŸĞšĞ
async function buy(price){
  if(currentBalance < price){
    alert("âŒ ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ ĞºĞ¾ÑˆÑ‚Ñ–Ğ²");
    return;
  }

  currentBalance -= price;

  await sb
    .from("bank")
    .update({ balance: currentBalance })
    .eq("user_id", currentUser.id);

  updateBalance();
  alert("âœ… ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾");
}

function buyLis(){
  const q = Number(qty.value || 1);
  buy(q * 0.3);
}

// ğŸšª Ğ’Ğ˜Ğ¥Ğ†Ğ”
function logout(){
  currentUser = null;
  bankBox.classList.add("hidden");
  loginBox.classList.remove("hidden");
}
</script>
</body>
</html>

